import os, sys
sys.path.append(os.path.join(os.path.dirname(__file__), '..'))

from src.basic.XMLLoader import XMLLoader

ENDPOINT = 'http://gaiadev01.isi.edu:3030/cu0912/query'


def run(xml_query, output='outputs/'):
    with open(xml_query) as f:
        xml = f.read()

    all_ans = XMLLoader(xml).answer_all(ENDPOINT)

    import json
    with open('outputs/v13graph.xml', 'w') as f:
        json.dump(all_ans, f, indent=2)

    for ans in all_ans:
        print(ans['sparql'])
        print(ans['response'])

# example graph query provided by NIST
# run('xml_queries/graph_query.xml')

# subgraph as query in our dataset
# run('xml_queries/autogenerated_query_2.xml')

run('xml_queries/zerohop_test1.xml')

# run('xml_queries/simple_query.xml')

# run('xml_queries/class_query.xml')

# run('v1.3/graph_query.xml')


# run('v1.3/zerohop_query.xml')
